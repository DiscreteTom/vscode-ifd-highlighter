{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "interactive fiction script",
	"patterns": [
		{
			"include": "#script"
		}
	],
	"repository": {
		"script": {
			"patterns": [{
				"begin": "^(@[^\\}]+)\\{",
				"end": "}",
				"beginCaptures": {
					"1": {
						"name": "keyword.control.ifd"
					}
				},
				"patterns": [
					{
						"include": "#actions"
					}
				]
			}]
		},
		"actions": {
			"patterns": [
				{
					"begin": "((([a-zA-Z0-9_]+)|\\(\\s*([a-zA-Z_][a-zA-Z0-9_]*)\\s*(:\\s*([^\\)]+))?\\)|\\s)+)\\{",
					"end": "\\}",
					"beginCaptures": {
						"1": {
							"name": "entity.name.function.ifd"
						},
						"4": {
							"name": "variable.parameter.ifd"
						},
						"6": {
							"name": "entity.name.class.ifd"
						}
					},
					"patterns": [
						{
							"include": "#built-in-func"
						},
						{
							"include": "#build-in-var"
						},
						{
							"include": "source.python"
						}
					]
				}
			]
		},
		"built-in-func": {
			"patterns": [
				{
					"match": "\\b(printItemList|print|printStory|parse|load|unload|run|findItem)\\b",
					"captures": {
						"1": {
							"name": "support.function.ifd"
						}
					}
				}
			]
		},
		"built-in-var": {
			"patterns": [
				{
					"match": "\\b(this|config|game|items)\\b",
					"captures": {
						"1": {
							"name": "variable.language.ifd"
						}
					}
				}
			]
		}
	},
	"scopeName": "source.ifd"
}